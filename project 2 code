#include "string.h"
#include "stdbool.h"
#include "stdio.h"

int main()
{
    int yes = 0;
    int no = 0;
    int abstain = 0;
    int voted = 0;
    int pass_change;
    int vote_change;
    long int user_ID[] = {20191706008,20191706020,20191706022};
    int user_password[] = {321,654,987};
    long int user_ID_input[] = {0,0,0};
    int user_password_input[] = {0,0,0};
    int vote[] = {0,0,0};
    for(int i = 0; i < (sizeof(user_ID)/sizeof(user_ID[0])); ++i){
        printf("Please enter your ID: ");
        scanf("%ld", &user_ID_input[i]);
        printf("Please enter your password: ");
        scanf("%d", &user_password_input[i]);
        if(i>0){
            for(int j=0; j<i; j++){
                if(user_ID_input[i] == user_ID_input[j]){
                    printf("You have already logged in \n");
                    voted = 1;
                }
                else{
                    voted = 0;
                }
            }
        }
        if(((user_ID_input[i]==user_ID[0] && user_password_input[i]==user_password[0]) || (user_ID_input[i]==user_ID[1] && user_password_input[i]==user_password[1]) || (user_ID_input[i]==user_ID[2] && user_password_input[i]==user_password[2]))&&voted==0){
            printf("Do you want to change your password? \n");
            scanf("%d", &pass_change);
            if(pass_change == 1){
                printf("Please enter your new password: \n");
                scanf("%d", &user_password[i]);
            }
            printf("Enter your vote 1 or 0 as yes or no respectively.\nIf you want to stay abstain, vote 2: ");
            scanf("%d", &vote[i]);
            printf("Are you sure?");
            scanf("%d", &vote_change);
            if(vote_change == 0){
                printf("Enter your vote 1 or 0 as yes or no respectively.\nIf you want to stay abstain, vote 2: ");
                scanf("%d", &vote[i]);
            }
            if(vote[i] == 2){
                abstain = abstain+1;
            }
            if(vote[i] == 1){
                yes = yes+1;
            }
            if(vote[i] == 0){
                no = no+1;
            }
            if(vote[i] != 0 && vote[i] != 1 && vote[i] != 2){
                return printf("Invalid vote. \n");
            }
            if(yes>(sizeof(user_ID)/sizeof(user_ID[0]))/2){
            	printf("The result of voting is YES, because of the majority.");
				printf("Votes for Yes = %d\n",yes);
        		printf("Votes for No = %d\n",no);
            	return 0;
			}
			if(no>(sizeof(user_ID)/sizeof(user_ID[0]))/2){
				printf("The result of voting is NO, because of the majority.");
				printf("Votes for Yes = %d\n",yes);
        		printf("Votes for No = %d\n",no);
				return 0;
			}
        }
        else{
            if(voted == 0){
                printf("Your ID or password is wrong. \n");
            }
        }
    }
    FILE *vt;
    vt = fopen("votes.txt", "w");
    fprintf(vt,"Yes: %d\n", yes);
    fprintf(vt,"No: %d\n", no);
    fprintf(vt,"Abstain: %d\n", abstain);
    fclose(vt);
    
    if(yes>no){
        printf("Votes for Yes = %d\n",yes);
        printf("Votes for No = %d\n",no);
        printf("The result of voting is YES");
        return 0;
    }
    if(no>yes){
        printf("Votes for Yes = %d\n",yes);
        printf("Votes for No = %d\n",no);
        printf("The result of voting is NO");
        return 0;
    }
    if (no==yes && no != 0 && yes !=0){
        printf("Votes for Yes = %d\n",yes);
        printf("Votes for No = %d\n",no);
        printf("The result of voting is DRAW");
        return 0; 
    }
    if (no == 0 && yes == 0 && abstain > yes && abstain > no){
        printf("Votes for Yes = %d\n",yes);
        printf("Votes for No = %d\n",no);
        printf("The result of voting is ABSTAIN");
        return 0; 
    }
 
}
